# 朝までそれ正解
QuizKnock が YouTube でやっている「朝までそれ正解」を Slack でやるためのスクリプトです。
回答の集計を行うことが可能で、発表時まで他者の回答はわからないようにして遊べます。
お題はサポートしていないので各自用意してください。

## 用意するもの
- Slack の Slash Commands を2つ
- Slack の Incoming Webhook URL
- 専用の Google Spread Sheet

## 雑な使い方
- このスクリプトを GAS に登録
- <>で囲まれているものを適切なものに置き換える(<>自体も含めて置き換えること)
- Slack で設定した Slash Command を打つと動く
-- 送信は Command の後ろに 回答を添える、発表はそれ単体でよい

## 動かし方をもう少し詳しく
我々は回答の送信(集計)に "/send_soreseikai"、発表に "/open_soreseikai" という Command をそれぞれ使っているので、以下の記述はそれに準じます。

"/send_soreseikai <回答>" と送ると、「<User_Name>が回答したよ!」というメッセージが Incoming Webhook により投稿されます。これが返ってきたら送信できています。

一度送信したユーザが再度送信すると、前の回答に新しい回答が上書きされ、「<User_Name>が再回答したよ!」というメッセージが投稿されます。


"/open_soreseikai" と送ると、回答が以下の形で Incoming Webhook により投稿されます。

>回答発表!
>
>ユーザA「回答A」
>
>ユーザB「回答B」
>
>ユーザC「回答C」
>
>(以下、回答者の人数分続く)

## 動作
### 送信
受け取った回答と、その回答をしたユーザの User Name・User ID を専用のスプレッドシートに、一人に付き一行ずつ入力していきます。
入力前にスプレッドシートの中身をチェックし、IDが一致するユーザの回答があれば同じ行の回答と User Name を新しいもので置き換え、そうでなければ新しい行として追加します。
### 発表
スプレッドシートに保存されている回答と User Name を、上に示した形に整形します。
その後、スプレッドシートを空にし、整形したテキストを Slack に送信します。
